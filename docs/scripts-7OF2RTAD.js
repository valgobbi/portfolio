(function(Y,B){typeof exports=="object"&&typeof module<"u"?module.exports=B():typeof define=="function"&&define.amd?define(B):(Y=typeof globalThis<"u"?globalThis:Y||self).KeenSlider=B()})(this,function(){"use strict";var Y=function(){return Y=Object.assign||function(t){for(var n,i=1,l=arguments.length;i<l;i++)for(var f in n=arguments[i])Object.prototype.hasOwnProperty.call(n,f)&&(t[f]=n[f]);return t},Y.apply(this,arguments)};function B(t,n,i){if(i||arguments.length===2)for(var l,f=0,a=n.length;f<a;f++)!l&&f in n||(l||(l=Array.prototype.slice.call(n,0,f)),l[f]=n[f]);return t.concat(l||Array.prototype.slice.call(n))}function it(t){return Array.prototype.slice.call(t)}function nt(t,n){var i=Math.floor(t);return i===n||i+1===n?t:n}function et(){return Date.now()}function $(t,n,i){if(n="data-keen-slider-"+n,i===null)return t.removeAttribute(n);t.setAttribute(n,i||"")}function Q(t,n){return n=n||document,typeof t=="function"&&(t=t(n)),Array.isArray(t)?t:typeof t=="string"?it(n.querySelectorAll(t)):t instanceof HTMLElement?[t]:t instanceof NodeList?it(t):[]}function K(t){t.raw&&(t=t.raw),t.cancelable&&!t.defaultPrevented&&t.preventDefault()}function G(t){t.raw&&(t=t.raw),t.stopPropagation&&t.stopPropagation()}function rt(){var t=[];return{add:function(n,i,l,f){n.addListener?n.addListener(l):n.addEventListener(i,l,f),t.push([n,i,l,f])},input:function(n,i,l,f){this.add(n,i,function(a){return function(r){r.nativeEvent&&(r=r.nativeEvent);var y=r.changedTouches||[],w=r.targetTouches||[],s=r.detail&&r.detail.x?r.detail:null;return a({id:s?s.identifier?s.identifier:"i":w[0]?w[0]?w[0].identifier:"e":"d",idChanged:s?s.identifier?s.identifier:"i":y[0]?y[0]?y[0].identifier:"e":"d",raw:r,x:s&&s.x?s.x:w[0]?w[0].screenX:s?s.x:r.pageX,y:s&&s.y?s.y:w[0]?w[0].screenY:s?s.y:r.pageY})}}(l),f)},purge:function(){t.forEach(function(n){n[0].removeListener?n[0].removeListener(n[2]):n[0].removeEventListener(n[1],n[2],n[3])}),t=[]}}}function tt(t,n,i){return Math.min(Math.max(t,n),i)}function V(t){return(t>0?1:0)-(t<0?1:0)||+t}function at(t){var n=t.getBoundingClientRect();return{height:nt(n.height,t.offsetHeight),width:nt(n.width,t.offsetWidth)}}function j(t,n,i,l){var f=t&&t[n];return f==null?i:l&&typeof f=="function"?f():f}function R(t){return Math.round(1e6*t)/1e6}function ct(t){var n,i,l,f,a,r;function y(k){r||(r=k),w(!0);var C=k-r;C>l&&(C=l);var m=f[i];if(m[3]<C)return i++,y(k);var T=m[2],z=m[4],p=m[0],g=m[1]*(0,m[5])(z===0?1:(C-T)/z);if(g&&t.track.to(p+g),C<l)return M();r=null,w(!1),s(null),t.emit("animationEnded")}function w(k){n.active=k}function s(k){n.targetIdx=k}function M(){var k;k=y,a=window.requestAnimationFrame(k)}function O(){var k;k=a,window.cancelAnimationFrame(k),w(!1),s(null),r&&t.emit("animationStopped"),r=null}return n={active:!1,start:function(k){if(O(),t.track.details){var C=0,m=t.track.details.position;i=0,l=0,f=k.map(function(T){var z,p=Number(m),g=(z=T.earlyExit)!==null&&z!==void 0?z:T.duration,h=T.easing,S=T.distance*h(g/T.duration)||0;m+=S;var A=l;return l+=g,C+=S,[p,T.distance,A,l,T.duration,h]}),s(t.track.distToIdx(C)),M(),t.emit("animationStarted")}},stop:O,targetIdx:null}}function dt(t){var n,i,l,f,a,r,y,w,s,M,O,k,C,m,T=1/0,z=[],p=null,g=0;function h(u){F(g+u)}function S(u){var d=A(g+u).abs;return o(d)?d:null}function A(u){var d=Math.floor(Math.abs(R(u/i))),e=R((u%i+i)%i);e===i&&(e=0);var v=V(u),c=y.indexOf(B([],y,!0).reduce(function(D,L){return Math.abs(L-e)<Math.abs(D-e)?L:D})),x=c;return v<0&&d++,c===r&&(x=0,d+=v>0?1:-1),{abs:x+d*r*v,origin:c,rel:x}}function I(u,d,e){var v;if(d||!H())return P(u,e);if(!o(u))return null;var c=A(e??g),x=c.abs,D=u-c.rel,L=x+D;v=P(L);var _=P(L-r*V(D));return(_!==null&&Math.abs(_)<Math.abs(v)||v===null)&&(v=_),R(v)}function P(u,d){if(d==null&&(d=R(g)),!o(u)||u===null)return null;u=Math.round(u);var e=A(d),v=e.abs,c=e.rel,x=e.origin,D=q(u),L=(d%i+i)%i,_=y[x],N=Math.floor((u-(v-c))/r)*i;return R(_-L-_+y[D]+N+(x===r?i:0))}function o(u){return E(u)===u}function E(u){return tt(u,s,M)}function H(){return f.loop}function q(u){return(u%r+r)%r}function F(u){var d;d=u-g,z.push({distance:d,timestamp:et()}),z.length>6&&(z=z.slice(-6)),g=R(u);var e=b().abs;if(e!==p){var v=p!==null;p=e,v&&t.emit("slideChanged")}}function b(u){var d=u?null:function(){if(r){var e=H(),v=e?(g%i+i)%i:g,c=(e?g%i:g)-a[0][2],x=0-(c<0&&e?i-Math.abs(c):c),D=0,L=A(g),_=L.abs,N=L.rel,U=a[N][2],Z=a.map(function(X,mt){var W=x+D;(W<0-X[0]||W>1)&&(W+=(Math.abs(W)>i-1&&e?i:0)*V(-W));var ot=mt-N,ut=V(ot),J=ot+_;e&&(ut===-1&&W>U&&(J+=r),ut===1&&W<U&&(J-=r),O!==null&&J<O&&(W+=i),k!==null&&J>k&&(W-=i));var st=W+X[0]+X[1],ht=Math.max(W>=0&&st<=1?1:st<0||W>1?0:W<0?Math.min(1,(X[0]+W)/X[0]):(1-W)/X[0],0);return D+=X[0]+X[1],{abs:J,distance:f.rtl?-1*W+1-X[0]:W,portion:ht,size:X[0]}});return _=E(_),N=q(_),{abs:E(_),length:l,max:m,maxIdx:M,min:C,minIdx:s,position:g,progress:e?v/i:g/l,rel:N,slides:Z,slidesLength:i}}}();return n.details=d,t.emit("detailsChanged"),d}return n={absToRel:q,add:h,details:null,distToIdx:S,idxToDist:I,init:function(u){if(function(){if(f=t.options,a=(f.trackConfig||[]).map(function(c){return[j(c,"size",1),j(c,"spacing",0),j(c,"origin",0)]}),r=a.length){i=R(a.reduce(function(c,x){return c+x[0]+x[1]},0));var e,v=r-1;l=R(i+a[0][2]-a[v][0]-a[v][2]-a[v][1]),y=a.reduce(function(c,x){if(!c)return[0];var D=a[c.length-1],L=c[c.length-1]+(D[0]+D[2])+D[1];return L-=x[2],c[c.length-1]>L&&(L=c[c.length-1]),L=R(L),c.push(L),(!e||e<L)&&(w=c.length-1),e=L,c},null),l===0&&(w=0),y.push(R(i))}}(),!r)return b(!0);var d;(function(){var e=t.options.range,v=t.options.loop;O=s=v?j(v,"min",-1/0):0,k=M=v?j(v,"max",T):w;var c=j(e,"min",null),x=j(e,"max",null);c!==null&&(s=c),x!==null&&(M=x),C=s===-1/0?s:t.track.idxToDist(s||0,!0,0),m=M===T?M:I(M,!0,0),x===null&&(k=M),j(e,"align",!1)&&M!==T&&a[q(M)][2]===0&&(m-=1-a[q(M)][0],M=S(m-g)),C=R(C),m=R(m)})(),d=u,Number(d)===d?h(P(E(u))):b()},to:F,velocity:function(){var u=et(),d=z.reduce(function(e,v){var c=v.distance,x=v.timestamp;return u-x>200||(V(c)!==V(e.distance)&&e.distance&&(e={distance:0,lastTimestamp:0,time:0}),e.time&&(e.distance+=c),e.lastTimestamp&&(e.time+=x-e.lastTimestamp),e.lastTimestamp=x),e},{distance:0,lastTimestamp:0,time:0});return d.distance/d.time||0}}}function lt(t){var n,i,l,f,a,r,y,w;function s(p){return 2*p}function M(p){return tt(p,y,w)}function O(p){return 1-Math.pow(1-p,3)}function k(){return l?t.track.velocity():0}function C(){z();var p=t.options.mode==="free-snap",g=t.track,h=k();f=V(h);var S=t.track.details,A=[];if(h||!p){var I=m(h),P=I.dist,o=I.dur;if(o=s(o),P*=f,p){var E=g.idxToDist(g.distToIdx(P),!0);E&&(P=E)}A.push({distance:P,duration:o,easing:O});var H=S.position,q=H+P;if(q<a||q>r){var F=q<a?a-H:r-H,b=0,u=h;if(V(F)===f){var d=Math.min(Math.abs(F)/Math.abs(P),1),e=function(x){return 1-Math.pow(1-x,1/3)}(d)*o;A[0].earlyExit=e,u=h*(1-d)}else A[0].earlyExit=0,b+=F;var v=m(u,100),c=v.dist*f;t.options.rubberband&&(A.push({distance:c,duration:s(v.dur),easing:O}),A.push({distance:-c+b,duration:500,easing:O}))}t.animator.start(A)}else t.moveToIdx(M(S.abs),!0,{duration:500,easing:function(x){return 1+--x*x*x*x*x}})}function m(p,g){g===void 0&&(g=1e3);var h=147e-9+(p=Math.abs(p))/g;return{dist:Math.pow(p,2)/h,dur:p/h}}function T(){var p=t.track.details;p&&(a=p.min,r=p.max,y=p.minIdx,w=p.maxIdx)}function z(){t.animator.stop()}t.on("updated",T),t.on("optionsChanged",T),t.on("created",T),t.on("dragStarted",function(){l=!1,z(),n=i=t.track.details.abs}),t.on("dragChecked",function(){l=!0}),t.on("dragEnded",function(){var p=t.options.mode;p==="snap"&&function(){var g=t.track,h=t.track.details,S=h.position,A=V(k());(S>r||S<a)&&(A=0);var I=n+A;h.slides[g.absToRel(I)].portion===0&&(I-=A),n!==i&&(I=i),V(g.idxToDist(I,!0))!==A&&(I+=A),I=M(I);var P=g.idxToDist(I,!0);t.animator.start([{distance:P,duration:500,easing:function(o){return 1+--o*o*o*o*o}}])}(),p!=="free"&&p!=="free-snap"||C()}),t.on("dragged",function(){i=t.track.details.abs})}function ft(t){var n,i,l,f,a,r,y,w,s,M,O,k,C,m,T,z,p,g,h=rt();function S(b){if(r&&w===b.id){var u=o(b);if(s){if(!P(b))return I(b);M=u,s=!1,t.emit("dragChecked")}if(z)return M=u;K(b);var d=function(v){if(p===-1/0&&g===1/0)return v;var c=t.track.details,x=c.length,D=c.position,L=tt(v,p-D,g-D);if(x===0)return 0;if(!t.options.rubberband)return L;if(D<=g&&D>=p||D<p&&i>0||D>g&&i<0)return v;var _=(D<p?D-p:D-g)/x,N=f*x,U=Math.abs(_*N),Z=Math.max(0,1-U/a*2);return Z*Z*v}(y(M-u)/f*l);i=V(d);var e=t.track.details.position;(e>p&&e<g||e===p&&i>0||e===g&&i<0)&&G(b),O+=d,!k&&Math.abs(O*f)>5&&(k=!0),t.track.add(d),M=u,t.emit("dragged")}}function A(b){!r&&t.track.details&&t.track.details.length&&(O=0,r=!0,k=!1,s=!0,w=b.id,P(b),M=o(b),t.emit("dragStarted"))}function I(b){r&&w===b.idChanged&&(r=!1,t.emit("dragEnded"))}function P(b){var u=E(),d=u?b.y:b.x,e=u?b.x:b.y,v=C!==void 0&&m!==void 0&&Math.abs(m-e)<=Math.abs(C-d);return C=d,m=e,v}function o(b){return E()?b.y:b.x}function E(){return t.options.vertical}function H(){f=t.size,a=E()?window.innerHeight:window.innerWidth;var b=t.track.details;b&&(p=b.min,g=b.max)}function q(b){k&&(G(b),K(b))}function F(){if(h.purge(),t.options.drag&&!t.options.disabled){var b;b=t.options.dragSpeed||1,y=typeof b=="function"?b:function(d){return d*b},l=t.options.rtl?-1:1,H(),n=t.container,function(){var d="data-keen-slider-clickable";Q("[".concat(d,"]:not([").concat(d,"=false])"),n).map(function(e){h.add(e,"dragstart",G),h.add(e,"mousedown",G),h.add(e,"touchstart",G)})}(),h.add(n,"dragstart",function(d){K(d)}),h.add(n,"click",q,{capture:!0}),h.input(n,"ksDragStart",A),h.input(n,"ksDrag",S),h.input(n,"ksDragEnd",I),h.input(n,"mousedown",A),h.input(n,"mousemove",S),h.input(n,"mouseleave",I),h.input(n,"mouseup",I),h.input(n,"touchstart",A,{passive:!0}),h.input(n,"touchmove",S,{passive:!1}),h.input(n,"touchend",I),h.input(n,"touchcancel",I),h.add(window,"wheel",function(d){r&&K(d)});var u="data-keen-slider-scrollable";Q("[".concat(u,"]:not([").concat(u,"=false])"),t.container).map(function(d){return function(e){var v;h.input(e,"touchstart",function(c){v=o(c),z=!0,T=!0},{passive:!0}),h.input(e,"touchmove",function(c){var x=E(),D=x?e.scrollHeight-e.clientHeight:e.scrollWidth-e.clientWidth,L=v-o(c),_=x?e.scrollTop:e.scrollLeft,N=x&&e.style.overflowY==="scroll"||!x&&e.style.overflowX==="scroll";if(v=o(c),(L<0&&_>0||L>0&&_<D)&&T&&N)return z=!0;T=!1,K(c),z=!1}),h.input(e,"touchend",function(){z=!1})}(d)})}}t.on("updated",H),t.on("optionsChanged",F),t.on("created",F),t.on("destroyed",h.purge)}function pt(t){var n,i,l=null;function f(C,m,T){t.animator.active?r(C,m,T):requestAnimationFrame(function(){return r(C,m,T)})}function a(){f(!1,!1,i)}function r(C,m,T){var z=0,p=t.size,g=t.track.details;if(g&&n){var h=g.slides;n.forEach(function(S,A){if(C)!l&&m&&w(S,null,T),s(S,null,T);else{if(!h[A])return;var I=h[A].size*p;!l&&m&&w(S,I,T),s(S,h[A].distance*p-z,T),z+=I}})}}function y(C){return t.options.renderMode==="performance"?Math.round(C):C}function w(C,m,T){var z=T?"height":"width";m!==null&&(m=y(m)+"px"),C.style["min-"+z]=m,C.style["max-"+z]=m}function s(C,m,T){if(m!==null){m=y(m);var z=T?m:0;m="translate3d(".concat(T?0:m,"px, ").concat(z,"px, 0)")}C.style.transform=m,C.style["-webkit-transform"]=m}function M(){n&&(r(!0,!0,i),n=null),t.on("detailsChanged",a,!0)}function O(){f(!1,!0,i)}function k(){M(),i=t.options.vertical,t.options.disabled||t.options.renderMode==="custom"||(l=j(t.options.slides,"perView",null)==="auto",t.on("detailsChanged",a),(n=t.slides).length&&O())}t.on("created",k),t.on("optionsChanged",k),t.on("beforeOptionsChanged",function(){M()}),t.on("updated",O),t.on("destroyed",M)}function vt(t,n){return function(i){var l,f,a,r,y,w,s=rt();function M(o){var E;$(i.container,"reverse",(E=i.container,window.getComputedStyle(E,null).getPropertyValue("direction")!=="rtl"||o?null:"")),$(i.container,"v",i.options.vertical&&!o?"":null),$(i.container,"disabled",i.options.disabled&&!o?"":null)}function O(){k()&&p()}function k(){var o=null;if(r.forEach(function(H){H.matches&&(o=H.__media)}),o===l)return!1;l||i.emit("beforeOptionsChanged"),l=o;var E=o?a.breakpoints[o]:a;return i.options=Y(Y({},a),E),M(),I(),P(),h(),!0}function C(o){var E=at(o);return(i.options.vertical?E.height:E.width)/i.size||1}function m(){return i.options.trackConfig.length}function T(o){for(var E in l=!1,a=Y(Y({},n),o),s.purge(),f=i.size,r=[],a.breakpoints||[]){var H=window.matchMedia(E);H.__media=E,r.push(H),s.add(H,"change",O)}s.add(window,"orientationchange",A),s.add(window,"resize",S),k()}function z(o){i.animator.stop();var E=i.track.details;i.track.init(o??(E?E.abs:0))}function p(o){z(o),i.emit("optionsChanged")}function g(o,E){if(o)return T(o),void p(E);I(),P();var H=m();h(),m()!==H?p(E):z(E),i.emit("updated")}function h(){var o=i.options.slides;if(typeof o=="function")return i.options.trackConfig=o(i.size,i.slides);for(var E=i.slides,H=E.length,q=typeof o=="number"?o:j(o,"number",H,!0),F=[],b=j(o,"perView",1,!0),u=j(o,"spacing",0,!0)/i.size||0,d=b==="auto"?u:u/b,e=j(o,"origin","auto"),v=0,c=0;c<q;c++){var x=b==="auto"?C(E[c]):1/b-u+d,D=e==="center"?.5-x/2:e==="auto"?0:e;F.push({origin:D,size:x,spacing:u}),v+=x}if(v+=u*(q-1),e==="auto"&&!i.options.loop&&b!==1){var L=0;F.map(function(_){var N=v-L;return L+=_.size+u,N>=1||(_.origin=1-N-(v>1?0:1-v)),_})}i.options.trackConfig=F}function S(){I();var o=i.size;i.options.disabled||o===f||(f=o,g())}function A(){S(),setTimeout(S,500),setTimeout(S,2e3)}function I(){var o=at(i.container);i.size=(i.options.vertical?o.height:o.width)||1}function P(){i.slides=Q(i.options.selector,i.container)}i.container=(w=Q(t,y||document)).length?w[0]:null,i.destroy=function(){s.purge(),i.emit("destroyed"),M(!0)},i.prev=function(){i.moveToIdx(i.track.details.abs-1,!0)},i.next=function(){i.moveToIdx(i.track.details.abs+1,!0)},i.update=g,T(i.options)}}return function(t,n,i){try{return function(l,f){var a,r={};return a={emit:function(y){r[y]&&r[y].forEach(function(s){s(a)});var w=a.options&&a.options[y];w&&w(a)},moveToIdx:function(y,w,s){var M=a.track.idxToDist(y,w);if(M){var O=a.options.defaultAnimation;a.animator.start([{distance:M,duration:j(s||O,"duration",500),easing:j(s||O,"easing",function(k){return 1+--k*k*k*k*k})}])}},on:function(y,w,s){s===void 0&&(s=!1),r[y]||(r[y]=[]);var M=r[y].indexOf(w);M>-1?s&&delete r[y][M]:s||r[y].push(w)},options:l},function(){if(a.track=dt(a),a.animator=ct(a),f)for(var y=0,w=f;y<w.length;y++)(0,w[y])(a);a.track.init(a.options.initial||0),a.emit("created")}(),a}(n,B([vt(t,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),pt,ft,lt],i||[],!0))}catch(l){console.error(l)}}});
